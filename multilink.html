<!-- manual page source format generated by PolyglotMan v3.0.7, -->
<!-- available via anonymous ftp from ftp.cs.berkeley.edu:/ucb/people/phelps/tcltk/rman.tar.Z -->

<HTML>
<HEAD>
<TITLE>Multilink(1) Manual Page</TITLE>
</HEAD>
<BODY bgcolor=white>
<A HREF="#toc">Table of Contents</A><P>
 
<H2><A NAME="sect0" HREF="#toc0">Name </A></H2>
multilink - Palm multi segment linker, version 0.3.  
<H2><A NAME="sect1" HREF="#toc1">Synopsis </A></H2>
<B>multilink</B> 
<B>[</B><I>option</I><B>|</B><I>filename</I><B>]</B><I>...</I>  
<H2><A NAME="sect2" HREF="#toc2">Description </A></H2>
<B>Multilink</B> is a command line tool that can 
create multiple code segment applications and shared library files for 
the Palm Computing Platform. Multilink takes as input object files or libraries 
generated using gcc for PalmOS, as output multilink generates resource 
files corresponding to the application or shared library code, data, and 
relocation segments. As such multilink replaces the normal gcc-as-linker 
and obj-res steps in the build process. In addition, multilink generates 
the linker output files for each segment (the .out files), these files 
are required for debugging with gdb and may be used with binutils tools 
like nm. <P>
NOTE: The <B>multilink</B> command you use probably comes in the form 
of the <B>m68k-palmos-coff-multilink</B> command (for use with the older prc-tools 
0.5 tool chain), or <B>m68k-palmos-multilink</B> command (for use with the newer 
prc-tools 2.0 tool chain). For simplicity, this man page uses the simplified 
<B>multilink</B> name to refer to both forms of the command.  
<H2><A NAME="sect3" HREF="#toc3">Options </A></H2>
The <I>filename</I> 
arguments may be any combination of object file or archive file names, 
or archive files specified using the <B>-Ldir</B>, <B>-lname</B> syntax. In addition <B>-stdlib</B> 
specifies that the standard libraries ( -lc and -lgcc ) should be included. 
<P>
The <I>option</I> arguments may be intermixed with <I>filename</I> arguments, but in 
some cases, <I>option</I> arguments only effect the <I>filename</I> arguments that follow. 
The following describes the options that normally will be used: 
<DL>

<DT><B>-basename&nbsp;</B><I>name</I> 
 </DT>
<DD>Specify the basename for output files. The basename is used in generating 
the output coff files <I>(basenameNNNN.out)</I> needed for debugging and the output 
grc files <I>(TYPEXXXX.basename.grc)</I>  used to build your prc database. </DD>

<DT><B>-fid&nbsp;</B><I>fid</I> 
 </DT>
<DD>FtrID jmptables will be installed using this ID. Without getting into 
too much detail, multilink stores it's inter-segment jump tables using a 
call to FtrSet(). This option specifies the creator ID passed as the first 
argument to this call. Normally this option should match the create ID 
of your application, and normally you should specify this option. </DD>

<DT><B>-gdb-script&nbsp;</B><I>filename</I> 
 </DT>
<DD>Generate script with useful gdb commands. Out of the box, gdb does not 
know how to debug applications created using multilink. This option will 
generate a script with a useful 'load-segments' command tailored to your 
application. </DD>

<DT><B>-g</B>  </DT>
<DD>use debug versions of startup files. </DD>

<DT><B>-help</B>  </DT>
<DD>Print the standard 
usage information. </DD>

<DT><B>-segmentmap&nbsp;</B><I>file</I>  </DT>
<DD>Explicitly define segments. Normally 
multilink automatically allocates objects to segments using a simple <I>keep</I> 
<I>adding</I> <I>until</I> <I>the</I> <I>segment</I> <I>is</I> <I>full</I> algorithm. Using a segmentmap file you 
may explicitly specify segments and which objects should go in each. The 
syntax of the segmentmap file is simple: objects are specified one per 
line, and a new segment is specified using the <I>'</I><B>&lt;segment&gt;</B><I>'</I> keyword. If the 
end of the segmentmap file is encountered before all objects have been 
specified, remaining objects will allocated according to the automatic 
algorithm. </DD>

<DT><B>-l</B><I>name</I>  </DT>
<DD>Use the library named <I>name</I> when linking.  
<!--
 
  
-->
Multilink 
searches a standard list of directories for the library, which is  actually 
 a  file  named 'lib<I>name</I>.a'.<I></I> The linker then uses this file as if it had been 
specified precisely by name. The directories searched include  several 
 standard system  directories  plus any that you specify with <B>-L</B>. </DD>

<DT><B>-L</B><I>dir</I>  
</DT>
<DD>Add  directory dir to the list of directories to be searched for <B>-l</B>. </DD>

<DT><B>-segmentsize&nbsp;</B><I>n</I><B>[</B><I>k</I><B>]&nbsp;</B> 
 </DT>
<DD>Define maximum segment size (default is 30k). This option defines the 
maximum size of each segment. The theoretical maximum is currently 32k 
(16 bit relative addressing), but a fudge factor is usually needed. When 
using the a4-globals based tool chain (m68-palmos-coff-gcc) a smaller segment 
size is recommended as the fudge factor needs to be big enough to include 
the larger runtime support (27k seems to work well). If your links are 
failing with obscure error messages about the size of a branch, try a 
smaller segment size. Sorry, this is a bit lame.  </DD>

<DT><B>-stdlib</B>  </DT>
<DD>link standard 
libs (-lc and -lgcc) into target. </DD>

<DT><B>-nostdlib</B>  </DT>
<DD>do not link standard libs into 
target </DD>

<DT><B>-syslib</B>  </DT>
<DD>Tell multilink target will be a System Library (default 
is target will be an app). This options changes the startup files that 
are linked into the target, changes the expected entry point from PilotMain 
to ShlibMain, and changes the resource type of that code segment from 
code0001 to libr0000. </DD>

<DT><B>-verbose</B>  </DT>
<DD>Be more verbose. There are multiple levels 
of verbosity. </DD>

<DT><B>-version</B>  </DT>
<DD>Print the version number. </DD>
</DL>
<P>
The following options are 
somewhat esoteric and are not normally needed: 
<DL>

<DT><B>-debug</B>  </DT>
<DD>Output random debugging 
noise. This is mainly used for debugging multilink, but may be useful in 
overcoming sleeplessness. </DD>

<DT><B>-leavetmp</B>  </DT>
<DD>Leave generated glue files around. In 
the normal process of building your program, multilink generates a number 
of temporary assembler, and object files. Normally these are removed after 
use. This option disables the normal cleanup. </DD>

<DT><B>-libdir&nbsp;</B><I>dir</I>  </DT>
<DD>Directory to look 
for startup files. The multilink command uses a number of Palm code files 
to handle things at runtime. This option specifies where to find those 
files. Normally, the default location is correct and this option is not 
needed. </DD>

<DT><B>-stdlib&nbsp;</B><I>path</I>  </DT>
<DD>Path to look for standard library files (libgcc.a and 
libc.a). <I>Path</I> is a colon separated list of directories that multilink will 
look for the standard libraries (if they are being used). Normally, the 
default path is correct and this option is not needed. </DD>

<DT><B>-unused</B>  </DT>
<DD>Dump unused 
symbols. Useful in finding code that could be left out of your application. 
</DD>

<DT><B>-use-compiler&nbsp;</B><I>compiler</I>  </DT>
<DD>Specify compiler to use. Multilink calls this command 
to compile assembler (.s) files and to link object (.o) files. Normally, 
the default path is correct and this option is not needed. <I>Path</I> is a colon 
separated list of directories that multilink will look for the standard 
libraries (if they are being used). Normally, the default path is correct 
and this option is not needed. </DD>

<DT><B>-a4-globals</B>  </DT>
<DD>Generate runtime code using a4-rel 
globals. Stay away. </DD>

<DT><B>-a5-globals</B>  </DT>
<DD>Generate runtime code using a5-rel globals. 
Stay away. </DD>

<DT><B>-relocation-old</B>  </DT>
<DD>Assume gcc 2.7 relocation information. Stay away. 
</DD>

<DT><B>-relocation-new</B>  </DT>
<DD>Assume gcc 2.95 relocation information. Stay away. </DD>
</DL>
 
<H2><A NAME="sect4" HREF="#toc4">Environment 
Variables </A></H2>

<DL>

<DT><B>MULTILINK_LIBDIR</B>  </DT>
<DD>If specified, this variable specifies the 
directory multilink will look for the Palm runtime files, just like the 
<B>-libdir</B> option. The <B>-libdir</B> option overrides this variable. </DD>

<DT><B>MULTILINK_STDLIBPATH</B> 
 </DT>
<DD>If specified, this variable specifies the path multilink will look for 
the standard library files (libc.a and libgcc.a), just like the <B>-stdlibpath</B> 
option. The <B>-stdlibpath</B> option overrides this variable. </DD>
</DL>
 
<H2><A NAME="sect5" HREF="#toc5">Examples </A></H2>
The following 
example links all the objects in the current directory into a target application: 
<P>
<B>multilink -basename myapp -fid MYAP -g -stdlib *.o</B> <P>
The application code has 
access to the standard libraries (-stdlib), is debuggable using gdb (-g), 
will have a creator ID of 'MYAP' (-fid) and the multilink output files will 
use 'myapp' in their name. <P>
The following example demonstrates links object 
in the current directory with some libraries: <P>
<B>multilink ... *.o libmath.a -L../ui 
-lui -lgcc</B> <P>
The following example shows how the -gdb-script option could be 
used: <P>
<B>$ m68k-palmos-multilink ... -gdb-script script.gdb *.o</B>  <BR>
<B>$ par | build-prc |</B> <I>some</I> tool for building the prc  <BR>
<B>$ m68k-palmos-gdb myapp0000.out</B>  <BR>
<B>(gdb) source script.gdb</B>  <BR>
<B>(gdb) target pilot localhost:2000</B>  <BR>
<B>(gdb) load-segments</B> <P>
The following example shows how multilink could be 
used with pilrc and par: <P>
<B>rm -f *.bin *.grc</B>  <BR>
<B>pilrc resources.rcp</B>  <BR>
<B>m68k-palmos-multilink -fid MYAP *.o</B>  <BR>
<B>par r myapp.prc MyApp appl MYAP *.bin *.grc</B> <P>
The following example shows how 
multilink could be used with pilrc and build-prc: <P>
<B>rm -f *.bin *.grc</B>  <BR>
<B>pilrc resources.rcp</B>  <BR>
<B>m68k-palmos-multilink -fid MYAP *.o</B>  <BR>
<B>build-prc myapp.prc MyApp MYAP *.bin *.grc</B>  
<H2><A NAME="sect6" HREF="#toc6">Author </A></H2>
<B>multilink</B> was written by 
David Williams, djw@djw.org. <P>

<HR><P>
<A NAME="toc"><B>Table of Contents</B></A><P>
<UL>
<LI><A NAME="toc0" HREF="#sect0">Name</A></LI>
<LI><A NAME="toc1" HREF="#sect1">Synopsis</A></LI>
<LI><A NAME="toc2" HREF="#sect2">Description</A></LI>
<LI><A NAME="toc3" HREF="#sect3">Options</A></LI>
<LI><A NAME="toc4" HREF="#sect4">Environment Variables</A></LI>
<LI><A NAME="toc5" HREF="#sect5">Examples</A></LI>
<LI><A NAME="toc6" HREF="#sect6">Author</A></LI>
</UL>
</BODY></HTML>
